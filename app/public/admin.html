<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Sistem Antrian</title>
    <link rel="icon" type="image/png" href="assets/favicon.png">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f0f2f5; }
        
        /* Header & Navigation */
        .header { background: #0066ff; color: white; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .header-top { display: flex; justify-content: space-between; align-items: center; padding: 15px 30px; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .logo { font-size: 24px; font-weight: bold; }
        .user-info { display: flex; align-items: center; gap: 15px; }
        .user-name { font-size: 14px; }
        .btn-logout { background: rgba(255,255,255,0.2); color: white; border: none; padding: 8px 20px; border-radius: 5px; cursor: pointer; font-weight: 500; }
        .btn-logout:hover { background: rgba(255,255,255,0.3); }
        
        .nav-menu { display: flex; padding: 0 30px; }
        .nav-item { padding: 15px 25px; color: white; text-decoration: none; cursor: pointer; border-bottom: 3px solid transparent; transition: all 0.3s; }
        .nav-item:hover { background: rgba(255,255,255,0.1); }
        .nav-item.active { border-bottom-color: white; background: rgba(255,255,255,0.1); }
        
        /* Content */
        .container { max-width: 1400px; margin: 30px auto; padding: 0 30px; }
        .page { display: none; }
        .page.active { display: block; }
        
        .section { background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px; }
        h2 { color: #333; margin-bottom: 20px; font-size: 24px; }
        h3 { color: #555; margin-bottom: 15px; font-size: 18px; }
        
        /* Status Cards */
        .status-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 20px; }
        .status-card { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px; border-radius: 10px; text-align: center; }
        .status-number { font-size: 48px; font-weight: bold; margin-bottom: 10px; }
        .status-label { font-size: 14px; opacity: 0.9; }
        
        /* Buttons */
        .button-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; }
        button { padding: 15px; border: none; border-radius: 8px; cursor: pointer; font-size: 16px; font-weight: 600; transition: all 0.3s; }
        button:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
        .btn-primary { background: #667eea; color: white; }
        .btn-success { background: #27ae60; color: white; }
        .btn-info { background: #2980b9; color: white; }
        .btn-danger { background: #dc3545; color: white; }
        .btn-secondary { background: #6c757d; color: white; }
        
        /* Form */
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: 600; color: #555; }
        input, select { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px; }
        
        /* Queue List */
        .queue-list { max-height: 400px; overflow-y: auto; }
        .queue-item { display: flex; justify-content: space-between; padding: 15px; background: #f8f9fa; margin-bottom: 10px; border-radius: 8px; border-left: 4px solid #667eea; }
        .queue-number { font-weight: bold; color: #667eea; font-size: 20px; }
        
        /* Page Links */
        .page-links { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
        .page-link-card { background: white; padding: 30px; border-radius: 10px; text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.1); transition: all 0.3s; cursor: pointer; text-decoration: none; color: #333; }
        .page-link-card:hover { transform: translateY(-5px); box-shadow: 0 4px 16px rgba(0,0,0,0.15); }
        .page-link-icon { font-size: 48px; margin-bottom: 15px; }
        .page-link-title { font-size: 18px; font-weight: 600; margin-bottom: 5px; }
        .page-link-desc { font-size: 14px; color: #777; }
        .tabs { display: flex; gap: 10px; margin-bottom: 20px; border-bottom: 2px solid #ddd; flex-wrap: wrap; }
        .tab { padding: 12px 24px; cursor: pointer; border: none; background: none; font-size: 16px; font-weight: 600; color: #666; border-bottom: 3px solid transparent; transition: all 0.3s; }
        .tab.active { color: #667eea; border-bottom-color: #667eea; }
        .tab:hover { color: #667eea; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-top">
            <div class="logo">üé´ Sistem Antrian</div>
            <div class="user-info">
                <span class="user-name" id="userInfo">Loading...</span>
                <button class="btn-logout" onclick="logout()">Logout</button>
            </div>
        </div>
        <nav class="nav-menu">
            <a class="nav-item active" onclick="showPage('home')">Home</a>
            <a class="nav-item" onclick="showPage('pages')" id="navPages">Pages</a>
            <a class="nav-item" onclick="showPage('users')" id="navUsers" style="display:none;">Users</a>
            <a class="nav-item" onclick="showPage('settings')" id="navSettings" style="display:none;">Settings</a>
            <a class="nav-item" onclick="showPage('default-settings')" id="navDefaultSettings" style="display:none;">Default Setting</a>
            <a class="nav-item" onclick="showPage('printer')" id="navPrinter" style="display:none;">Printer</a>
            <a class="nav-item" onclick="showPage('slides')" id="navSlides" style="display:none;">Slides</a>
            <a class="nav-item" onclick="showPage('export')" id="navExport" style="display:none;">Export</a>
        </nav>
    </div>

    <div class="container">
        <!-- HOME PAGE -->
        <div id="home" class="page active">
            <div class="status-grid">
                <div class="status-card">
                    <div class="status-number" id="cs1">000</div>
                    <div class="status-label">CS 1</div>
                </div>
                <div class="status-card">
                    <div class="status-number" id="cs2">000</div>
                    <div class="status-label">CS 2</div>
                </div>
                <div class="status-card">
                    <div class="status-number" id="t1">000</div>
                    <div class="status-label">Teller 1</div>
                </div>
                <div class="status-card">
                    <div class="status-number" id="t2">000</div>
                    <div class="status-label">Teller 2</div>
                </div>
            </div>

            <div class="status-grid" style="grid-template-columns: repeat(2, 1fr);">
                <div class="status-card" style="background: linear-gradient(135deg, #27ae60 0%, #229954 100%);">
                    <div class="status-number" id="totalCS">0</div>
                    <div class="status-label">Antrian CS</div>
                </div>
                <div class="status-card" style="background: linear-gradient(135deg, #2980b9 0%, #1f618d 100%);">
                    <div class="status-number" id="totalTeller">0</div>
                    <div class="status-label">Antrian Teller</div>
                </div>
            </div>

            <div class="tabs">
                <button class="tab active" onclick="switchTab('waitingCS')">üìã Antrian CS</button>
                <button class="tab" onclick="switchTab('waitingTeller')">üìã Antrian Teller</button>
                <button class="tab" onclick="switchTab('calledCS')">‚úÖ Dipanggil CS</button>
                <button class="tab" onclick="switchTab('calledTeller')">‚úÖ Dipanggil Teller</button>
            </div>

            <div id="waitingCS" class="tab-content active">
                <div class="section">
                    <h3>üìã Daftar Antrian CS Menunggu <span id="avgTimeCS" style="font-size: 14px; color: #666; font-weight: normal;"></span></h3>
                    <div class="queue-list" id="queueCSList">
                        <p style="text-align: center; color: #999;">Tidak ada antrian</p>
                    </div>
                </div>
            </div>

            <div id="waitingTeller" class="tab-content">
                <div class="section">
                    <h3>üìã Daftar Antrian Teller Menunggu <span id="avgTimeTeller" style="font-size: 14px; color: #666; font-weight: normal;"></span></h3>
                    <div class="queue-list" id="queueTellerList">
                        <p style="text-align: center; color: #999;">Tidak ada antrian</p>
                    </div>
                </div>
            </div>

            <div id="calledCS" class="tab-content">
                <div class="section">
                    <h3>‚úÖ Antrian CS Sudah Dipanggil (Hari Ini)</h3>
                    <div class="queue-list" id="calledCSList">
                        <p style="text-align: center; color: #999;">Belum ada yang dipanggil</p>
                    </div>
                </div>
            </div>

            <div id="calledTeller" class="tab-content">
                <div class="section">
                    <h3>‚úÖ Antrian Teller Sudah Dipanggil (Hari Ini)</h3>
                    <div class="queue-list" id="calledTellerList">
                        <p style="text-align: center; color: #999;">Belum ada yang dipanggil</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- PAGES -->
        <div id="pages" class="page">
            <div class="section">
                <h2>üìÑ Halaman Publik</h2>
                <div class="page-links">
                    <a href="/ambil-nomor.html" target="_blank" class="page-link-card">
                        <div class="page-link-icon">üé´</div>
                        <div class="page-link-title">Ambil Nomor</div>
                        <div class="page-link-desc">Halaman untuk customer ambil nomor antrian</div>
                    </a>
                    <a href="/display" target="_blank" class="page-link-card">
                        <div class="page-link-icon">üì∫</div>
                        <div class="page-link-title">Display Screen</div>
                        <div class="page-link-desc">Tampilan nomor antrian (Static)</div>
                    </a>
                    <a href="/display-slide" target="_blank" class="page-link-card">
                        <div class="page-link-icon">üé¨</div>
                        <div class="page-link-title">Display Slide</div>
                        <div class="page-link-desc">Tampilan dengan slide gambar</div>
                    </a>
                </div>
            </div>
        </div>

        <!-- USERS -->
        <div id="users" class="page">
            <div class="section" style="padding: 10px;">
                <iframe src="/users" style="width: 100%; height: calc(100vh - 120px); border: none; border-radius: 8px;"></iframe>
            </div>
        </div>

        <!-- SETTINGS -->
        <div id="settings" class="page">
            <div class="section">
                <h2>‚öôÔ∏è Pengaturan Display</h2>
                <iframe src="/settings" style="width: 100%; height: 80vh; border: none; border-radius: 8px;"></iframe>
            </div>
        </div>

        <!-- DEFAULT SETTINGS -->
        <!-- <div id="default-settings" class="page">
            <div class="section">
                <h2>üîß Default Setting</h2>
                <iframe src="/default-settings" style="width: 100%; height: 80vh; border: none; border-radius: 8px;"></iframe>
            </div>
        </div> -->

        <!-- PRINTER -->
        <div id="printer" class="page">
            <div class="section">
                <h2>üñ®Ô∏è Pengaturan Printer Struk</h2>
                <iframe src="/printer-settings" style="width: 100%; height: 80vh; border: none; border-radius: 8px;"></iframe>
            </div>
        </div>

        <!-- SLIDES -->
        <div id="slides" class="page">
            <div class="section">
                <h2>üì∏ Manajemen Slide Gambar</h2>
                <div id="premiumStatus" style="text-align: center; padding: 20px; background: #f8f9fa; border-radius: 8px; margin-bottom: 20px;">
                    <p style="font-size: 16px; margin-bottom: 15px;">Status Fitur: <span id="statusText" style="font-weight: bold;">Checking...</span></p>
                    <div id="activationForm" style="display: none;">
                        <input type="password" id="passcode" placeholder="Masukkan Passcode" style="width: 250px; padding: 10px; font-size: 14px; margin-right: 10px; border: 1px solid #ddd; border-radius: 5px;">
                        <button class="btn-primary" onclick="activatePremium()" style="padding: 10px 25px; font-size: 14px;">Aktivasi </button>
                    </div>
                    <div id="activatedMessage" style="display: none;">
                        <span style="color: #27ae60; font-weight: bold;">‚úÖ Fitur Aktif</span>
                    </div>
                </div>
                <iframe src="/slides" style="width: 100%; height: 70vh; border: none; border-radius: 8px;"></iframe>
            </div>
        </div>

        <!-- EXPORT -->
        <div id="export" class="page">
            <div class="section">
                <h2>üì• Export Data Transaksi</h2>
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-bottom: 20px;">
                    <div class="form-group">
                        <label>Tanggal Mulai:</label>
                        <input type="date" id="startDate">
                    </div>
                    <div class="form-group">
                        <label>Tanggal Akhir:</label>
                        <input type="date" id="endDate">
                    </div>
                    <div class="form-group">
                        <label>Counter:</label>
                        <select id="filterCounter">
                            <option value="">Semua Counter</option>
                            <option value="cs1">CS 1</option>
                            <option value="cs2">CS 2</option>
                            <option value="t1">Teller 1</option>
                            <option value="t2">Teller 2</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Tipe Antrian:</label>
                        <select id="filterType">
                            <option value="">Semua Tipe</option>
                            <option value="cs">CS</option>
                            <option value="teller">Teller</option>
                        </select>
                    </div>
                </div>
                <button class="btn-primary" onclick="exportData()" style="width: 100%; padding: 15px; font-size: 18px;">
                    üì• Download CSV
                </button>
            </div>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        let userRole = '';
        
        fetch('/api/user')
            .then(res => res.json())
            .then(data => {
                if (data.user) {
                    userRole = data.user.role;
                    document.getElementById('userInfo').textContent = `${data.user.full_name || data.user.username} (${data.user.role.toUpperCase()})`;
                    
                    if (data.user.role === 'admin') {
                        document.getElementById('navUsers').style.display = 'block';
                        document.getElementById('navSettings').style.display = 'block';
                        document.getElementById('navDefaultSettings').style.display = 'block';
                        document.getElementById('navPrinter').style.display = 'block';
                        document.getElementById('navSlides').style.display = 'block';
                        document.getElementById('navExport').style.display = 'block';
                    }
                }
            })
            .catch(() => window.location.href = '/login.html');
        
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            event.target.classList.add('active');
            
            if (pageId === 'slides') {
                checkPremiumStatus();
            }
        }
        
        async function logout() {
            await fetch('/api/logout', { method: 'POST' });
            window.location.href = '/login.html';
        }
        
        const socket = io();
        socket.on('queueUpdated', (data) => {
            document.getElementById('totalCS').textContent = data.totalCS || 0;
            document.getElementById('totalTeller').textContent = data.totalTeller || 0;
            document.getElementById('cs1').textContent = data.counters.cs1.current;
            document.getElementById('cs2').textContent = data.counters.cs2.current;
            document.getElementById('t1').textContent = data.counters.t1.current;
            document.getElementById('t2').textContent = data.counters.t2.current;
            
            const queueCSList = document.getElementById('queueCSList');
            const queueCS = data.queueCS || [];
            const avgCS = data.avgServiceTime?.cs || 10;
            document.getElementById('avgTimeCS').textContent = `(Rata-rata layanan: ~${avgCS} menit)`;
            
            if (queueCS.length === 0) {
                queueCSList.innerHTML = '<p style="text-align: center; color: #999;">Tidak ada antrian</p>';
            } else {
                const now = new Date();
                queueCSList.innerHTML = queueCS.map((item, index) => {
                    const waitingSince = Math.round((now - new Date(item.timestamp)) / 60000);
                    const estimatedWait = (index + 1) * avgCS;
                    const totalWait = waitingSince + estimatedWait;
                    
                    let timeColor = '#ff6b6b';
                    let timeIcon = '‚è±Ô∏è';
                    if (totalWait > 30) {
                        timeColor = '#e74c3c';
                        timeIcon = '‚ö†Ô∏è';
                    } else if (totalWait > 20) {
                        timeColor = '#f39c12';
                    }
                    
                    return `
                    <div class="queue-item">
                        <div>
                            <span class="queue-number">${item.number}</span>
                            <span> - ${item.name}</span>
                            <span style="margin-left: 10px; color: ${timeColor}; font-size: 12px; font-weight: ${totalWait > 30 ? 'bold' : 'normal'};">${timeIcon} ~${totalWait} menit (tunggu: ${waitingSince}m)</span>
                        </div>
                        <small>${new Date(item.timestamp).toLocaleTimeString()}</small>
                    </div>
                `}).join('');
            }
            
            const queueTellerList = document.getElementById('queueTellerList');
            const queueTeller = data.queueTeller || [];
            const avgTeller = data.avgServiceTime?.teller || 10;
            document.getElementById('avgTimeTeller').textContent = `(Rata-rata layanan: ~${avgTeller} menit)`;
            
            if (queueTeller.length === 0) {
                queueTellerList.innerHTML = '<p style="text-align: center; color: #999;">Tidak ada antrian</p>';
            } else {
                const now = new Date();
                queueTellerList.innerHTML = queueTeller.map((item, index) => {
                    const waitingSince = Math.round((now - new Date(item.timestamp)) / 60000);
                    const estimatedWait = (index + 1) * avgTeller;
                    const totalWait = waitingSince + estimatedWait;
                    
                    let timeColor = '#ff6b6b';
                    let timeIcon = '‚è±Ô∏è';
                    if (totalWait > 30) {
                        timeColor = '#e74c3c';
                        timeIcon = '‚ö†Ô∏è';
                    } else if (totalWait > 20) {
                        timeColor = '#f39c12';
                    }
                    
                    return `
                    <div class="queue-item">
                        <div>
                            <span class="queue-number">${item.number}</span>
                            <span> - ${item.name}</span>
                            <span style="margin-left: 10px; color: ${timeColor}; font-size: 12px; font-weight: ${totalWait > 30 ? 'bold' : 'normal'};">${timeIcon} ~${totalWait} menit (tunggu: ${waitingSince}m)</span>
                        </div>
                        <small>${new Date(item.timestamp).toLocaleTimeString()}</small>
                    </div>
                `}).join('');
            }
            
            loadCalledQueue();
        });
        
        loadCalledQueue();
        
        async function loadCalledQueue() {
            try {
                const today = new Date().toISOString().split('T')[0];
                const response = await fetch(`/api/transactions?startDate=${today}&endDate=${today}`);
                const result = await response.json();
                
                if (result.success && result.transactions.length > 0) {
                    const csFiltered = result.transactions.filter(t => t.queue_type === 'cs' && t.status === 'called' && t.called_at);
                    const calledCSList = document.getElementById('calledCSList');
                    if (csFiltered.length === 0) {
                        calledCSList.innerHTML = '<p style="text-align: center; color: #999;">Belum ada yang dipanggil</p>';
                    } else {
                        calledCSList.innerHTML = csFiltered.map((item, index) => {
                            let serviceTime = null;
                            let timeColor = '#2980b9';
                            let timeIcon = '‚è±Ô∏è';
                            
                            if (index < csFiltered.length - 1 && csFiltered[index + 1].called_at && item.called_at) {
                                serviceTime = Math.round((new Date(item.called_at) - new Date(csFiltered[index + 1].called_at)) / 60000);
                                
                                if (serviceTime > 15) {
                                    timeColor = '#e74c3c';
                                    timeIcon = '‚ö†Ô∏è';
                                } else if (serviceTime > 10) {
                                    timeColor = '#f39c12';
                                }
                            }
                            
                            return `
                            <div class="queue-item" style="border-left-color: #28a745;">
                                <div>
                                    <span class="queue-number" style="color: #28a745;">${item.queue_number}</span>
                                    <span> - ${item.customer_name || '-'}</span>
                                    <span style="margin-left: 10px; color: #666;">[${item.counter?.toUpperCase() || '-'}]</span>
                                    ${serviceTime && serviceTime > 0 ? `<span style="margin-left: 10px; color: ${timeColor}; font-size: 12px; font-weight: ${serviceTime > 15 ? 'bold' : 'normal'};">${timeIcon} ${serviceTime} menit</span>` : ''}
                                </div>
                                <small>${item.called_at ? new Date(item.called_at).toLocaleTimeString() : '-'}</small>
                            </div>
                        `}).join('');
                    }
                    
                    const tellerFiltered = result.transactions.filter(t => t.queue_type === 'teller' && t.status === 'called' && t.called_at);
                    const calledTellerList = document.getElementById('calledTellerList');
                    if (tellerFiltered.length === 0) {
                        calledTellerList.innerHTML = '<p style="text-align: center; color: #999;">Belum ada yang dipanggil</p>';
                    } else {
                        calledTellerList.innerHTML = tellerFiltered.map((item, index) => {
                            let serviceTime = null;
                            let timeColor = '#2980b9';
                            let timeIcon = '‚è±Ô∏è';
                            
                            if (index < tellerFiltered.length - 1 && tellerFiltered[index + 1].called_at && item.called_at) {
                                serviceTime = Math.round((new Date(item.called_at) - new Date(tellerFiltered[index + 1].called_at)) / 60000);
                                
                                if (serviceTime > 15) {
                                    timeColor = '#e74c3c';
                                    timeIcon = '‚ö†Ô∏è';
                                } else if (serviceTime > 10) {
                                    timeColor = '#f39c12';
                                }
                            }
                            
                            return `
                            <div class="queue-item" style="border-left-color: #28a745;">
                                <div>
                                    <span class="queue-number" style="color: #28a745;">${item.queue_number}</span>
                                    <span> - ${item.customer_name || '-'}</span>
                                    <span style="margin-left: 10px; color: #666;">[${item.counter?.toUpperCase() || '-'}]</span>
                                    ${serviceTime && serviceTime > 0 ? `<span style="margin-left: 10px; color: ${timeColor}; font-size: 12px; font-weight: ${serviceTime > 15 ? 'bold' : 'normal'};">${timeIcon} ${serviceTime} menit</span>` : ''}
                                </div>
                                <small>${item.called_at ? new Date(item.called_at).toLocaleTimeString() : '-'}</small>
                            </div>
                        `}).join('');
                    }
                }
            } catch (error) {
                console.error('Error loading called queue:', error);
            }
        }
        
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }
        
        function exportData() {
            const params = new URLSearchParams();
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;
            const counter = document.getElementById('filterCounter').value;
            const type = document.getElementById('filterType').value;
            
            if (startDate) params.append('startDate', startDate);
            if (endDate) params.append('endDate', endDate);
            if (counter) params.append('counter', counter);
            if (type) params.append('type', type);
            
            window.location.href = `/api/export-transactions?${params.toString()}`;
        }
        
        async function checkPremiumStatus() {
            try {
                const response = await fetch('/api/premium-status');
                const result = await response.json();
                
                if (result.success) {
                    if (result.is_activated) {
                        document.getElementById('statusText').textContent = 'Aktif';
                        document.getElementById('statusText').style.color = '#27ae60';
                        document.getElementById('activatedMessage').style.display = 'inline';
                        document.getElementById('activationForm').style.display = 'none';
                    } else {
                        document.getElementById('statusText').textContent = 'Belum Aktif';
                        document.getElementById('statusText').style.color = '#dc3545';
                        document.getElementById('activationForm').style.display = 'inline';
                        document.getElementById('activatedMessage').style.display = 'none';
                    }
                }
            } catch (error) {
                console.error('Error checking premium status:', error);
            }
        }
        
        async function activatePremium() {
            const passcode = document.getElementById('passcode').value;
            
            if (!passcode) {
                alert('Masukkan passcode');
                return;
            }
            
            try {
                const response = await fetch('/api/activate-premium', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ passcode })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    alert('Premium berhasil diaktifkan!');
                    checkPremiumStatus();
                } else {
                    alert(result.message || 'Aktivasi gagal');
                }
            } catch (error) {
                alert('Error: ' + error.message);
            }
        }
    </script>
</body>
</html>
